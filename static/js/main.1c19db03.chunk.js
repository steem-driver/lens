(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{54:function(e,t,a){e.exports=a(94)},59:function(e,t,a){},94:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(24),o=a.n(c),l=(a(59),a(22)),s=a(13),i=a(100),u=a(101),d=a(97),m=a(98),h=a(99),p=a(15),g=a(16),f=a(20),v=a(17),y=a(21),b=a(18),k=a.n(b),E=a(19),H=(a(29),function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(v.a)(t).call(this,e))).state={columns:[],data:[],pages:-1,loading:!0},a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(E.a,{className:"-highlight -striped",columns:this.columns(),data:this.state.data,pageSize:20,loading:this.state.loading,onFetchData:function(t,a){0===t.data.length&&(e.setState({loading:!0}),e.fetchData())}})}},{key:"columns",value:function(){var e=this.props,t=e.token,a=e.account,n=e.table,r=[{Header:"Date",accessor:"timestamp"},{Header:a?"Token":"Account",accessor:a?"symbol":"account"},{Header:a?"Amount":"".concat(t," Amount"),accessor:"quantity"},{Header:"Steem Amount",accessor:"volume"},{Header:"Price (Steem)",accessor:"price"}],c=[{Header:"Price (Steem)",accessor:"price"},{Header:"Steem Amount",accessor:"volume"},{Header:a?"Amount":"".concat(t," Amount"),accessor:"quantity"},{Header:a?"Token":"Account",accessor:a?"symbol":"account"},{Header:"Date",accessor:"timestamp"}],o=[{Header:"Type",accessor:"type"},{Header:"Price (Steem)",accessor:"price"},{Header:"".concat(t," Amount"),accessor:"quantity"},{Header:"Steem Amount",accessor:"volume"},{Header:"Date",accessor:"timestamp"}];return"tradesHistory"===n?o:"buyBook"===n?r:"sellBook"===n?c:null}},{key:"fetchData",value:function(){var e=this,t=this.props,a=t.token,n=t.account,r=t.table,c=t.index,o=t.descending,l={};a&&(l.symbol=a),n&&(l.account=n),k.a.post("https://api.steem-engine.com/rpc/contracts",{jsonrpc:"2.0",id:18,method:"find",params:{contract:"market",table:r,query:l,limit:500,offset:0,indexes:[{index:c,descending:o}]}}).then(function(t){if(t&&t.data&&t.data.result){var a=t.data.result.map(function(e){for(var t=0,a=["quantity","price"];t<a.length;t++){var n=a[t];"undefined"!==typeof e[n]&&null!=e[n]&&(e[n]=Number(e[n]))}return e.volume||(e.volume=Number(e.price*e.quantity)),e.volume=Number(Number(e.volume).toFixed(3)),e.quantity=Number(Number(e.quantity).toFixed(3)),e.timestamp&&(e.timestamp=new Date(1e3*e.timestamp).toLocaleString()),e});e.setState({data:a,loading:!1})}})}}]),t}(r.a.Component)),S=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(v.a)(t).call(this,e))).state={columns:[],data:[],pages:-1,loading:!0},a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(E.a,{className:"-highlight -striped",columns:this.columns(),data:this.state.data,pageSize:20,loading:this.state.loading,onFetchData:function(t,a){0===t.data.length&&(e.setState({loading:!0}),e.fetchData(1))}})}},{key:"columns",value:function(){var e=this.props.token;return[{Header:"Type",accessor:"type"},{Header:"Buyer",accessor:"buyer"},{Header:"Seller",accessor:"seller"},{Header:"Price (Steem)",accessor:"price"},{Header:"".concat(e," Amount"),accessor:"quantity"},{Header:"Steem Amount",accessor:"volume"},{Header:"Date",accessor:"timestamp"}]}},{key:"fetchData",value:function(e){var t=this,a=this.props.token,n="https://steem-engine.rocks/transactions.json?symbol=".concat(a,"&contract=").concat("market","&per_page=").concat(500,"&page=").concat(e);k.a.get("".concat("https://cors-anywhere.herokuapp.com/").concat(n)).then(function(a){if(a&&a.data&&a.data.transactions&&a.data.transactions.length>0){t.fetchData(e+1);var n=[],r=!0,c=!1,o=void 0;try{for(var l,s=a.data.transactions[Symbol.iterator]();!(r=(l=s.next()).done);r=!0){var i=l.value,u=t.buildRows(i);null!=u&&(u.length>0?n=n.concat(u):n.push(u))}}catch(m){c=!0,o=m}finally{try{r||null==s.return||s.return()}finally{if(c)throw o}}var d=t.state.data.concat(n);t.setState({data:d,loading:!1})}})}},{key:"buildRows",value:function(e){var t=this.props.token;if(e.payload.symbol!==t)return null;if("buy"!==e.action&&"sell"!==e.action)return null;var a=e.logs.events.filter(function(e){return"transferFromContract"===e.event});if(a&&0!==a.length){for(var n=[],r=0;r+1<a.length;r+=2){var c=e.sender,o=this.getTradeInfo(c,t,[a[r],a[r+1]]),l=o.receiver,s=o.quantity,i=o.volume,u={type:e.action,timestamp:new Date(e.timestamp).toLocaleString(),price:Number(Number(i/s).toFixed(8)),quantity:Number(Number(s).toFixed(3)),volume:Number(Number(i).toFixed(3))};"buy"===u.type?(u.buyer=c,u.seller=l):"sell"===u.type&&(u.seller=c,u.buyer=l),n.push(u)}return n}return null}},{key:"getTradeInfo",value:function(e,t,a){var n=null,r=null,c=null,o=!0,l=!1,s=void 0;try{for(var i,u=a[Symbol.iterator]();!(o=(i=u.next()).done);o=!0){var d=i.value.data;d.to!==e&&(n=d.to),d.symbol===t?r=d.quantity:"STEEMP"===d.symbol&&(c=d.quantity)}}catch(m){l=!0,s=m}finally{try{o||null==u.return||u.return()}finally{if(l)throw s}}return{receiver:n,quantity:r,volume:c}}}]),t}(r.a.Component),O=a(46),w=function(e){var t=e.column,a=Object(O.sum)(t).toFixed(3);return r.a.createElement("span",{title:a},r.a.createElement("strong",null,"Sum:")," ",a)},x=function(e){var t=e.column.length;return r.a.createElement("span",{title:t},r.a.createElement("strong",null,"Count:")," ",t)},N=function(e,t){return e.map(function(e){return e[t]})},F=function(e){return r.a.createElement("span",null,e.value.toFixed(3))},j=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(f.a)(this,Object(v.a)(t).call(this,e))).state={columns:[],data:[],pages:-1,loading:!0},a.data=[],a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.index,n=t.descending;return r.a.createElement(E.a,{className:"-highlight -striped",columns:this.columns(),data:this.state.data,pageSize:100,defaultSorted:[{id:a,desc:n}],loading:this.state.loading,onFetchData:function(t,a){0===t.data.length&&(e.setState({loading:!0}),e.fetchData(0))}})}},{key:"columns",value:function(){var e=this.state.data;return[{Header:"#",id:"row",maxWidth:50,filterable:!1,sortable:!1,Cell:function(e){return r.a.createElement("div",null,e.page*e.pageSize+e.viewIndex+1)}},{Header:"Account",accessor:"account",Footer:r.a.createElement(x,{column:N(e,"account")})},{Header:"Balance",accessor:"balance",Footer:r.a.createElement(w,{column:N(e,"balance")})},{Header:"Staked",accessor:"stake",Footer:r.a.createElement(w,{column:N(e,"stake")})},{Header:"Pending Unstake",accessor:"pendingUnstake",Footer:r.a.createElement(w,{column:N(e,"pendingUnstake")})},{Header:"Delegation In",accessor:"delegationsIn",Footer:r.a.createElement(w,{column:N(e,"delegationsIn")})},{Header:"Delegations Out",accessor:"delegationsOut",Footer:r.a.createElement(w,{column:N(e,"delegationsOut")})},{Header:"Effective Stake",accessor:"effectiveStake",Cell:F,Footer:r.a.createElement(w,{column:N(e,"effectiveStake")})},{Header:"Balance + Staked",accessor:"totalAsset",Cell:F,Footer:r.a.createElement(w,{column:N(e,"totalAsset")})},{Header:"Total Holding",accessor:"totalHolding",Cell:F,Footer:r.a.createElement(w,{column:N(e,"totalHolding")})}]}},{key:"fetchData",value:function(e){var t=this,a=this.props.token;k.a.post("https://api.steem-engine.com/rpc/contracts",{jsonrpc:"2.0",id:1,method:"find",params:{contract:"tokens",table:"balances",query:{symbol:a},limit:1e3,offset:e}}).then(function(a){if(a&&a.data&&a.data.result)if(a.data.result.length>0){t.fetchData(e+1e3);var n=a.data.result.map(function(e){for(var t=0,a=["balance","stake","pendingUnstake","delegationsIn","delegationsOut","receivedStake","delegatedStake"];t<a.length;t++){var n=a[t];"undefined"!==typeof e[n]&&null!=e[n]?e[n]=Number(e[n]):e[n]=0}return e.delegationsIn=e.delegationsIn||e.receivedStake||0,e.delegationsOut=e.delegationsOut||e.delegatedStake||0,e.effectiveStake=e.stake+e.delegationsIn,e.totalAsset=e.balance+e.stake,e.totalHolding=e.totalAsset+e.delegationsIn,e}).filter(function(e){return e.totalHolding+e.delegationsOut+e.pendingUnstake>0});t.data=t.data.concat(n)}else t.setState({data:t.data,loading:!1})})}}]),t}(r.a.Component),D="lens",A=function(e){var t=e.location,a=new URLSearchParams(t.search),n=a.get("account"),c=a.get("token")||(n?"":"ENG"),o=a.get("page")||"open_order",s=function(){switch(o){case"open_order":return q;case"trade_history":return B;case"rich_list":return I;default:return null}}(),d="";return d+=n?"&account=".concat(n):"",d+=c?"&token=".concat(c):"",r.a.createElement("div",null,r.a.createElement(i.a,{bg:"dark",variant:"dark"},r.a.createElement(i.a.Brand,null,r.a.createElement("img",{alt:"",src:"".concat("/lens","/favicon.ico"),width:"30",height:"30",className:"d-inline-block align-top"})," Lens"),r.a.createElement(u.a,{className:"mr-auto"},r.a.createElement(l.b,{className:"nav-link",to:"/".concat(D,"?page=open_order").concat(d)},"Open Orders"),r.a.createElement(l.b,{className:"nav-link",to:"/".concat(D,"?page=trade_history").concat(d)},"Trade History"),r.a.createElement(l.b,{className:"nav-link",to:"/".concat(D,"?page=rich_list").concat(d)},"Rich List"))),r.a.createElement("br",null),r.a.createElement(s,{token:c,account:n}))},q=function(e){var t=e.token,a=e.account;return r.a.createElement(d.a,null,a?r.a.createElement(m.a,null,r.a.createElement(h.a,null,r.a.createElement("h3",null,"@",a," Buying Orders"),r.a.createElement(H,{token:t,account:a,table:"buyBook",index:"timestamp",descending:!0})),r.a.createElement(h.a,null,r.a.createElement("h3",null,"@",a," Selling Orders"),r.a.createElement(H,{token:t,account:a,table:"sellBook",index:"timestamp",descending:!0}))):r.a.createElement(m.a,null,r.a.createElement(h.a,null,r.a.createElement("h3",null,"People Buying ",t),r.a.createElement(H,{token:t,table:"buyBook",index:"price",descending:!0})),r.a.createElement(h.a,null,r.a.createElement("h3",null,"People Selling ",t),r.a.createElement(H,{token:t,table:"sellBook",index:"price",descending:!1}))))},B=function(e){var t=e.token;return r.a.createElement(d.a,null,r.a.createElement(m.a,null,r.a.createElement(h.a,null,r.a.createElement("h3",null,t," Trade History in 24 Hours"),r.a.createElement(H,{token:t,table:"tradesHistory",index:"timestamp",descending:!1}),r.a.createElement("br",null)," ",r.a.createElement("br",null)),r.a.createElement(h.a,null,r.a.createElement("h3",null,t," Whole Trade History with Buyers and Sellers"),r.a.createElement(S,{token:t,index:"timestamp",descending:!1}))))},I=function(e){var t=e.token;return r.a.createElement(d.a,null,r.a.createElement(m.a,null,r.a.createElement(h.a,null,r.a.createElement("h3",null,t," Rich List"),r.a.createElement(j,{token:t,index:"effectiveStake",descending:!0}))))};var T=function(){return r.a.createElement(l.a,null,r.a.createElement(s.a,{path:"/".concat(D),component:A}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[54,1,2]]]);
//# sourceMappingURL=main.1c19db03.chunk.js.map